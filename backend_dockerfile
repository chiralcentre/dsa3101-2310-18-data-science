# base image
FROM python:3.10.6-slim-buster

# Install git
RUN apt-get update && \
    apt-get upgrade -y && \
    apt-get install -y git && \
    apt-get install -y git-lfs

WORKDIR /app
COPY requirements.txt requirements.txt
ADD backend .

# Install necessary packages
RUN pip3 install --upgrade pip
RUN pip3 install -r requirements.txt

# Download resources for models
RUN ["python", "-c", "import nltk; nltk.download('punkt'); nltk.download('stopwords'); nltk.download('wordnet'); nltk.download('omw-1.4')" ]
RUN ["git", "lfs", "install"]
RUN ["git", "clone", "https://huggingface.co/bert-base-uncased"]

ENTRYPOINT python -u -m flask --app launch run --host=0.0.0.0
